FOR i IN range(0, len(X_train)):
    SET y_train[i] TO + y_train[i]

FOR char IN X_train[i]:
    IF char not IN INPUT_characters:
    INPUT_characters.add(char)

FOR char IN y_train[i]:
    IF char not IN target_characters:
    target_characters.add(char)

SET INPUT_characters TO sorted(list(INPUT_characters))
SET target_characters TO sorted(list(target_characters))
SET num_encoder_tokens TO len(INPUT_characters)
SET num_decoder_tokens TO len(target_characters)
SET max_X_len TO max([len(txt) FOR txt IN X_train])
SET max_y_len TO max([len(txt) FOR txt IN y_train])

IF max_X_len > max_encoder_seq_length:
    SET max_encoder_seq_length TO max_X_len

IF max_y_len > max_decoder_seq_length:
    SET max_decoder_seq_length TO max_y_len

OUTPUT(target_characters)

SET INPUT_token_index TO dict([(char, i) FOR i, char IN enumerate(INPUT_characters)])
SET target_token_index TO dict([(char, i) FOR i, char IN enumerate(target_characters)])
SET encoder_INPUT_data TO np.zeros(
    (len(X_train), max_encoder_seq_length, num_encoder_tokens), dtype = "float32"
)

SET decoder_INPUT_data TO np.zeros(
    (len(X_train), max_decoder_seq_length, num_decoder_tokens), dtype = "float32"
)

SET decoder_target_data TO np.zeros(
    (len(X_train), max_decoder_seq_length, num_decoder_tokens), dtype = "float32"
)

np.set_OUTPUToptions(threshold = 10)

FOR i, (INPUT_text, target_text) IN enumerate(zip(X_train, y_train)):
    FOR t, char IN enumerate(INPUT_text):
    SET encoder_INPUT_data[i, t, INPUT_token_index[char]] TO 1.0
SET encoder_INPUT_data[i, t + 1: , INPUT_token_index[" "]] TO 1.0
FOR t, char IN enumerate(target_text):
# decoder_target_data is ahead of decoder_INPUT_data by one timestep
SET decoder_INPUT_data[i, t, target_token_index[char]] TO 1.0
IF t > 0:
# decoder_target_data will be ahead by one timestep
# and will not include the start character.
SET decoder_target_data[i, t - 1, target_token_index[char]] TO 1.0
SET decoder_INPUT_data[i, t + 1: , target_token_index[" "]] TO 1.0
SET decoder_target_data[i, t: , target_token_index[" "]] TO 1.0